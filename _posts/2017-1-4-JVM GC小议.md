---

layout: post
categories: [Java]
tags: [Java,JVM]

---

# JVM GC小议

### JVM体系结构概况

![](https://raw.githubusercontent.com/kakack/kakack.github.io/master/_images/jvmgc1.jpg)

其中GC主要作用于方法区和堆。

其中：

 - **堆区** 储存的全是对象，被所有线程共享，没有基本类型和对象的引用，只有对象本身。
 - **栈区** 每个线程有一个栈区，保存基础类型的对象和自定义对象的引用，其中的内容是私有的，其他线程不能访问。
 - **方法区** 又称为静态区，同样被共享，包含所有class和static变量。

 - - -

### GC 算法
 
**引用计数法**

最简单的gc算法，原理是每个对象里保存该对象被引用的次数，每当发生引用增减时自我更新，当计数变成0的时候表示不再被引用，则可释放相应内存空间。优点是容易实现，预测准确。缺点是对象维护一个引用计数器本身也需要一定量的开销，容易产生线程不同步现象，另外无法判别循环引用的情况出现。

**标记清除/标记压缩算法**

首先从根开始将可能被引用的对象用递归的方式进行标记，然后将没有标记到的对象作为垃圾进行回收。如果是压缩的话就是对所有标记到的对象往一端滑动放到一起，将没标记的视为垃圾回收。

**复制收集算法**
 
将从根开始被引用的对象复制到另外的空间中，然后，再将复制的对象所能够引用的对象用递归的方式不断复制下去。

 ---
 
### Sun Hotspot内存管理

采用分代管理的办法